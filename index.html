<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/4.5.0/css/bootstrap.min.css">
  <title>2026é©¬é’é“å·æ£€æµ‹ç³»ç»Ÿ</title>
  <style>
    :root { --main-red: #d32f2f; --bg-gray: #f8f9fa; }
    body { background-color: var(--bg-gray); color: #333; font-family: -apple-system, sans-serif; }
    .container { max-width: 600px; padding-bottom: 40px; }
    .header-box { background: linear-gradient(135deg, #e74c3c 0%, var(--main-red) 100%); color: white; padding: 30px 15px; border-radius: 0 0 30px 30px; margin-bottom: 20px; box-shadow: 0 4px 15px rgba(211, 47, 47, 0.3); }
    .card { border: none; border-radius: 20px; box-shadow: 0 8px 25px rgba(0,0,0,0.05); }
    .btn-start { background-color: var(--main-red); border: none; font-weight: bold; padding: 14px; font-size: 1.1rem; border-radius: 12px; }
    .btn-start:active { transform: scale(0.97); }
    .table-responsive { border-radius: 15px; background: white; box-shadow: 0 4px 12px rgba(0,0,0,0.03); }
    #data thead th { border-top: none; background: #fafafa; color: #888; font-size: 0.75rem; text-transform: uppercase; }
    .badge-luck { background-color: #fff1f0; color: var(--main-red); border: 1px solid #ffa39e; margin: 2px; display: inline-block; padding: 3px 8px; border-radius: 6px; font-size: 0.8rem; font-weight: 500; }
    .num-text { font-family: "Monaco", "Consolas", monospace; font-weight: 700; color: #1a1a1a; letter-spacing: 0.5px; }
    .table-warning { background-color: #fffbe6 !important; }
  </style>
</head>
<body>

<div class="header-box text-center">
  <h2 class="mb-1">ğŸ´ 2026é©¬é’é“å·æ£€æµ‹</h2>
  <p class="mb-0 opacity-75 small">ä¸“ä¸šçº§é’±å¸æ”¶è—æ™ºèƒ½åˆ†æç³»ç»Ÿ</p>
</div>

<div class="container">
  <div class="card p-4">
    <div class="form-group">
      <label class="small text-muted font-weight-bold">é¦–é’ç¥¨å· (9ä½æ•°å­—)</label>
      <div class="input-group">
        <div class="input-group-prepend">
          <span class="input-group-text bg-light font-weight-bold text-danger">J</span>
        </div>
        <input type="number" pattern="\d*" class="form-control form-control-lg" id="cpnum" placeholder="è¾“å…¥9ä½æ•°å­—ï¼Œå¦‚ 001234567" autocomplete="off">
      </div>
    </div>
    
    <div class="form-group">
      <label class="small text-muted font-weight-bold">æ£€æµ‹è§„æ¨¡</label>
      <select class="form-control form-control-lg" id="num">
        <option value="1">å•å¼ æ£€æµ‹</option>
        <option value="10">åè¿ (æ•´æ¨)</option>
        <option value="20">äºŒåè¿</option>
        <option value="100">ç™¾è¿ (æ•´åˆ€)</option>
      </select>
    </div>

    <button type="button" class="btn btn-danger btn-block btn-start" onclick="start()">å¼€å¯æ™ºèƒ½è¯†åˆ«</button>
    <button type="button" class="btn btn-link btn-block btn-sm text-muted mt-2" onclick="toExcel()">å¯¼å‡º Excel æ•°æ®</button>
  </div>

  <div class="mt-4" id="resultArea" style="display: none;">
    <div class="table-responsive">
      <table class="table table-hover mb-0" id="data">
        <thead class="text-center">
          <tr>
            <th width="15%">åºå·</th>
            <th width="35%">ç¥¨å·</th>
            <th>ç‰¹å¾æ ‡ç­¾</th>
          </tr>
        </thead>
        <tbody class="text-center"></tbody>
      </table>
    </div>
  </div>
</div>

<footer class="text-center mt-4">
  <p class="text-muted small">Â© 2026 é©¬é’é“å·æ£€æµ‹ç³»ç»Ÿ v3.5<br>ä½œè€…dyï¼šå°èŒ—åŒå­¦</p>
</footer>

<script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.0/jquery.min.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/layer/3.5.1/layer.min.js"></script>

<script>
  /**
   * ç®—æ³•æ ¸å¿ƒï¼šå¤šç»´åº¦é“å·è¯†åˆ«
   */
  function checkNum(e) {
    let n = [];
    
    // 1. æ— 47 è§„åˆ™ï¼šå‰6ä½æ— 4æˆ–7 (ä¸è®¡å3ä½)
    if (!/[47]/.test(e.substring(0, 6))) n.push("æ— 47");
    
    // 2. æ— 347 è§„åˆ™ï¼šå‰7ä½æ— 3ã€4æˆ–7 (ä¸è®¡å2ä½)
    if (!/[347]/.test(e.substring(0, 7))) n.push("æ— 347");

    // 3. é©¬å¹´ç”Ÿæ—¥å· (åŒ¹é…é©¬å¹´ï¼š1966, 1978, 1990, 2002, 2014, 2026)
    const horseYears = "1966|1978|1990|2002|2014|2026";
    const birthRegex = new RegExp(`^(?:${horseYears})(0[1-9]|1[012])(0[1-9]|[12][0-9]|3[01])$`);
    if (e.slice(-8).match(birthRegex)) {
      n.push("é©¬å¹´ç”Ÿæ—¥å·");
    }

    // 4. å å·æ£€æµ‹ (è±¹å­ã€ç‹®å­ã€è€è™ã€é€šå¤©å·)
    const repeatMatch = e.match(/(\d)\1{2,}$/);
    if (repeatMatch) {
      const len = repeatMatch[0].length;
      const names = {3:"è±¹å­", 4:"ç‹®å­", 5:"è€è™", 6:"å¤§è±¡", 7:"æé¾™", 8:"éº’éºŸ", 9:"é€šå¤©"};
      if(names[len]) n.push(names[len] + "å·");
    }

    // 5. é¡ºå­æ£€æµ‹ (äº”ä½åŠä»¥ä¸Šé¡ºå­)
    if (/(01234|12345|23456|34567|45678|56789)/.test(e)) n.push("é¡ºå­å·");

    // 6. é›·è¾¾å· (æ­£åè¯»ä¸€è‡´)
    if (e === e.split("").reverse().join("")) n.push("é›·è¾¾å·");
    
    // 7. å€’ç½®å· (ç”±0,1,6,8,9ç»„æˆ) - å¸‚åœºçƒ­é—¨
    if (/^[01689]+$/.test(e)) n.push("å€’ç½®å·");

    // 8. 2026 çºªå¿µå·
    if (e.includes("2026")) n.push("2026å·");

    // 9. é©¬æ•°ç‰¹å¾ (å…¨å·ç”±å‡ ç§æ•°å­—ç»„æˆ)
    const sz = new Set(e).size;
    if (sz <= 3) n.push("é©¬" + (sz === 2 ? "äºŒ" : "ä¸‰"));

    return n.length > 0 ? n : ["æ™®é€š"];
  }

  function start() {
    const rawVal = $('#cpnum').val().trim();
    
    // æ¼æ´é˜²æŠ¤ï¼šæ ¡éªŒé•¿åº¦ä¸çº¯æ•°å­—
    if (rawVal.length !== 9 || !/^\d+$/.test(rawVal)) {
      layer.msg("è¯·è¾“å…¥9ä½æ•°å­—èµ·å§‹ç¥¨å·", {anim: 6});
      return;
    }

    const tab = $('#data tbody');
    tab.empty();
    const count = parseInt($('#num').val());
    
    // ä½¿ç”¨ BigInt è§£å†³ JS æ•´æ•°ç²¾åº¦æº¢å‡ºæ¼æ´
    const startNum = BigInt(rawVal);

    let htmlBuffer = '';
    for (let i = 0; i < count; i++) {
      let currentStr = (startNum + BigInt(i)).toString().padStart(9, "0");
      let traits = checkNum(currentStr);
      
      let tags = traits.map(f => `<span class="badge-luck">${f}</span>`).join('');
      let isSpecial = !(traits.length === 1 && traits[0] === "æ™®é€š");
      let rowClass = isSpecial ? "table-warning" : "";

      htmlBuffer += `<tr class="${rowClass}">
        <td class="small text-muted">${i + 1}</td>
        <td class="num-text">J${currentStr}</td>
        <td class="text-left">${tags}</td>
      </tr>`;
    }
    
    tab.append(htmlBuffer);
    $('#resultArea').show();
    layer.msg("è¯†åˆ«æˆåŠŸ");
    
    // ç§»åŠ¨ç«¯å¹³æ»‘æ»šåŠ¨è‡³ç»“æœåŒº
    if (count > 1) {
      $('html, body').animate({ scrollTop: $("#resultArea").offset().top - 20 }, 500);
    }
  }

  function toExcel() {
    const table = document.getElementById("data");
    if (table.rows.length <= 1) {
      layer.msg("è¯·å…ˆè¿›è¡Œæ£€æµ‹");
      return;
    }
    const blobHtml = `<html><head><meta charset='utf-8'></head><body>${table.outerHTML}</body></html>`;
    const blob = new Blob([blobHtml], { type: "application/vnd.ms-excel" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = `é©¬é’æ£€æµ‹_${new Date().getTime()}.xls`;
    a.click();
    URL.revokeObjectURL(url);
  }
</script>
</body>
</html>
